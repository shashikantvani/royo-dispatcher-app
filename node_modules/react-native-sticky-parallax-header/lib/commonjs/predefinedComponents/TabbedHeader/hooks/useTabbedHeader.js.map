{"version":3,"sources":["useTabbedHeader.tsx"],"names":["useRenderHeader","props","contentBackgroundColor","innerScrollHeight","onMomentumScrollEnd","onScroll","onScrollEndDrag","parallaxHeight","scrollHeight","scrollValue","scrollViewRef","backgroundColor","backgroundImage","foregroundImage","hasBorderRadius","tabsContainerBackgroundColor","title","titleStyle","titleTestID","horizontalScrollValue","onHorizontalPagerScroll","e","value","contentOffset","x","renderHeader","React","useCallback","useTabbedHeaderPager","initialPage","useState","currentPage","setCurrentPage","goToPage","pageNumber","prev","renderTabs","activeTab","onTabPressed","useTabbedHeaderList","ignoreViewabilityItemsChangedEvent","onMomentumScrollEndInternal","debouncedIgnoreViewabilityItemsChangedCallback","onScrollInternal","Platform","OS","sections","activeSection","setActiveSection","goToSection","sectionIndex","current","scrollToLocation","animated","itemIndex","viewPosition","onViewableItemsChanged","viewableItems","length","newActiveSection","findIndex","section","key"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport type { NativeScrollEvent, ScrollView, SectionList, ViewToken } from 'react-native';\nimport { Platform } from 'react-native';\nimport { runOnJS, useSharedValue, useWorkletCallback } from 'react-native-reanimated';\n\nimport type { ScrollComponent } from '../../common/SharedProps';\nimport { HeaderWrapper } from '../../common/components/HeaderWrapper';\nimport { usePredefinedHeader } from '../../common/hooks/usePredefinedHeader';\nimport { debounce } from '../../common/utils/debounce';\nimport type { TabbedHeaderListProps, TabbedHeaderPagerProps } from '../TabbedHeaderProps';\nimport { Foreground } from '../components/HeaderForeground';\n\nimport { useRenderTabs } from './useRenderTabs';\n\nfunction useRenderHeader<T extends ScrollComponent>(props: TabbedHeaderPagerProps) {\n  const {\n    contentBackgroundColor,\n    innerScrollHeight,\n    onMomentumScrollEnd,\n    onScroll,\n    onScrollEndDrag,\n    parallaxHeight,\n    scrollHeight,\n    scrollValue,\n    scrollViewRef,\n  } = usePredefinedHeader<T>(props);\n  const {\n    backgroundColor,\n    backgroundImage,\n    foregroundImage,\n    hasBorderRadius,\n    tabsContainerBackgroundColor,\n    title,\n    titleStyle,\n    titleTestID,\n  } = props;\n  const horizontalScrollValue = useSharedValue(0);\n  const onHorizontalPagerScroll = useWorkletCallback((e: NativeScrollEvent) => {\n    horizontalScrollValue.value = e.contentOffset.x;\n  }, []);\n\n  const renderHeader = React.useCallback(() => {\n    return (\n      <HeaderWrapper\n        backgroundColor={backgroundColor}\n        backgroundImage={backgroundImage}\n        contentBackgroundColor={contentBackgroundColor}\n        hasBorderRadius={hasBorderRadius}\n        parallaxHeight={parallaxHeight}\n        scrollHeight={scrollHeight}\n        scrollValue={scrollValue}\n        tabsContainerBackgroundColor={tabsContainerBackgroundColor}>\n        <Foreground\n          height={parallaxHeight}\n          scrollValue={scrollValue}\n          foregroundImage={foregroundImage}\n          title={title}\n          titleStyle={titleStyle}\n          titleTestID={titleTestID}\n        />\n      </HeaderWrapper>\n    );\n  }, [\n    backgroundColor,\n    backgroundImage,\n    contentBackgroundColor,\n    foregroundImage,\n    hasBorderRadius,\n    parallaxHeight,\n    scrollHeight,\n    scrollValue,\n    tabsContainerBackgroundColor,\n    title,\n    titleStyle,\n    titleTestID,\n  ]);\n\n  return {\n    innerScrollHeight,\n    horizontalScrollValue,\n    onHorizontalPagerScroll,\n    onMomentumScrollEnd,\n    onScroll,\n    onScrollEndDrag,\n    renderHeader,\n    scrollHeight,\n    scrollValue,\n    scrollViewRef,\n  };\n}\n\nexport function useTabbedHeaderPager(props: TabbedHeaderPagerProps) {\n  const {\n    innerScrollHeight,\n    horizontalScrollValue,\n    onHorizontalPagerScroll,\n    onMomentumScrollEnd,\n    onScroll,\n    onScrollEndDrag,\n    renderHeader,\n    scrollHeight,\n    scrollValue,\n    scrollViewRef,\n  } = useRenderHeader<ScrollView>(props);\n  const { backgroundColor, initialPage, tabsContainerBackgroundColor } = props;\n  const [currentPage, setCurrentPage] = React.useState(initialPage ?? 0);\n\n  const goToPage = React.useCallback((pageNumber: number) => {\n    setCurrentPage((prev) => {\n      if (prev !== pageNumber) {\n        return pageNumber;\n      }\n\n      return prev;\n    });\n  }, []);\n\n  const renderTabs = useRenderTabs({\n    ...props,\n    activeTab: currentPage,\n    horizontalScrollValue,\n    onTabPressed: goToPage,\n    tabsContainerBackgroundColor: tabsContainerBackgroundColor ?? backgroundColor,\n  });\n\n  return {\n    currentPage,\n    goToPage,\n    innerScrollHeight,\n    onHorizontalPagerScroll,\n    onMomentumScrollEnd,\n    onScroll,\n    onScrollEndDrag,\n    renderHeader,\n    renderTabs,\n    scrollHeight,\n    scrollValue,\n    scrollViewRef,\n    setCurrentPage,\n  };\n}\n\nexport function useTabbedHeaderList<\n  ItemT,\n  SectionT,\n  T extends SectionList<ItemT, SectionT> = SectionList<ItemT, SectionT>\n>(props: TabbedHeaderListProps<ItemT, SectionT>) {\n  const ignoreViewabilityItemsChangedEvent = useSharedValue(false);\n  const {\n    innerScrollHeight,\n    horizontalScrollValue,\n    onMomentumScrollEnd,\n    onScroll,\n    onScrollEndDrag,\n    renderHeader,\n    scrollValue,\n    scrollViewRef,\n  } = useRenderHeader<T>(props);\n  const onMomentumScrollEndInternal = useWorkletCallback(\n    (e: NativeScrollEvent) => {\n      ignoreViewabilityItemsChangedEvent.value = false;\n      onMomentumScrollEnd?.(e);\n    },\n    [onMomentumScrollEnd]\n  );\n  const debouncedIgnoreViewabilityItemsChangedCallback = debounce(() => {\n    ignoreViewabilityItemsChangedEvent.value = false;\n  }, 100);\n  const onScrollInternal = useWorkletCallback(\n    (e: NativeScrollEvent) => {\n      if (Platform.OS === 'web') {\n        // On web there is no onMomentumScrollEnd\n        runOnJS(debouncedIgnoreViewabilityItemsChangedCallback)();\n      }\n\n      onScroll?.(e);\n    },\n    [onScroll]\n  );\n\n  const { backgroundColor, sections, tabsContainerBackgroundColor } = props;\n\n  const [activeSection, setActiveSection] = React.useState(0);\n\n  const goToSection = React.useCallback((sectionIndex: number) => {\n    ignoreViewabilityItemsChangedEvent.value = true;\n    scrollViewRef.current?.scrollToLocation({\n      animated: true,\n      itemIndex: 0,\n      sectionIndex,\n      viewPosition: 0,\n    });\n    setActiveSection(sectionIndex);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onViewableItemsChanged = React.useCallback(\n    ({ viewableItems }: { viewableItems: ViewToken[]; changed: ViewToken[] }) => {\n      if (!viewableItems.length || ignoreViewabilityItemsChangedEvent.value) {\n        return;\n      }\n\n      const newActiveSection = sections.findIndex(\n        (section) => section.key === viewableItems[0].section?.key\n      );\n\n      if (newActiveSection !== -1) {\n        setActiveSection(newActiveSection);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [sections]\n  );\n\n  const renderTabs = useRenderTabs({\n    ...props,\n    activeTab: activeSection,\n    horizontalScrollValue,\n    onTabPressed: goToSection,\n    tabsContainerBackgroundColor: tabsContainerBackgroundColor ?? backgroundColor,\n  });\n\n  return {\n    goToSection,\n    innerScrollHeight,\n    onMomentumScrollEnd: onMomentumScrollEndInternal,\n    onScroll: onScrollInternal,\n    onScrollEndDrag,\n    onViewableItemsChanged,\n    renderHeader,\n    renderTabs,\n    scrollValue,\n    scrollViewRef,\n  };\n}\n"]}
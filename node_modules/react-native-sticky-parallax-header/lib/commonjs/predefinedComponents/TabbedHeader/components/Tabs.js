var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.Tabs=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var React=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeReanimated=_interopRequireWildcard(require("react-native-reanimated"));var _constants=require("../../../constants");var _parseAnimatedColorProp=require("../../common/utils/parseAnimatedColorProp");var _TabItem=require("./TabItem");var _this=this,_jsxFileName="/Users/vagrant/git/src/predefinedComponents/TabbedHeader/components/Tabs.tsx";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}var UNDERLINE_PADDING=20;var Tabs=function Tabs(_ref){var tabs=_ref.tabs,activeTab=_ref.activeTab,horizontalScrollValue=_ref.horizontalScrollValue,onTabPressed=_ref.onTabPressed,tabsContainerBackgroundColor=_ref.tabsContainerBackgroundColor,tabsContainerStyle=_ref.tabsContainerStyle,tabTextContainerStyle=_ref.tabTextContainerStyle,tabTextContainerActiveStyle=_ref.tabTextContainerActiveStyle,tabWrapperStyle=_ref.tabWrapperStyle,tabUnderlineColor=_ref.tabUnderlineColor,tabTextActiveStyle=_ref.tabTextActiveStyle,tabTextStyle=_ref.tabTextStyle,tabsContainerHorizontalPadding=_ref.tabsContainerHorizontalPadding;var _useWindowDimensions=(0,_reactNative.useWindowDimensions)(),width=_useWindowDimensions.width;var horizontalScrollRef=React.useRef(null);var currentPositionX=React.useRef(0);var _React$useState=React.useState(tabs.map(function(_){return 0;})),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),tabsWidth=_React$useState2[0],setTabsWidth=_React$useState2[1];var isInvertedAndroid=_reactNative.Platform.OS==='android'?_reactNative.I18nManager.isRTL:undefined;var isInvertedIOS=_reactNative.Platform.OS==='ios'?_reactNative.I18nManager.isRTL:undefined;var adjustPrevious=React.useCallback(function(page){var lastHidden=Math.floor(currentPositionX.current/(width*0.3));if(page<=lastHidden){var _horizontalScrollRef$;currentPositionX.current=width*0.3*page;(_horizontalScrollRef$=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$.scrollTo({animated:true,x:currentPositionX.current});}},[width]);var adjustNext=React.useCallback(function(page){var invisibleX=width+currentPositionX.current-width*0.3*(page+1);if(invisibleX<0){var _horizontalScrollRef$2;currentPositionX.current=currentPositionX.current-invisibleX;(_horizontalScrollRef$2=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$2.scrollTo==null?void 0:_horizontalScrollRef$2.scrollTo({animated:true,x:currentPositionX.current});}},[width]);var scrollToTab=React.useCallback(function(page){if(tabs.length>3){if(page===0){var _horizontalScrollRef$3;(_horizontalScrollRef$3=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$3.scrollTo({animated:true,x:0});currentPositionX.current=0;}else if(page!==tabs.length-1){adjustPrevious(page-1);adjustNext(page+1);}else{var _horizontalScrollRef$4;(_horizontalScrollRef$4=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$4.scrollToEnd==null?void 0:_horizontalScrollRef$4.scrollToEnd({animated:true});currentPositionX.current=width*0.3*tabs.length-width;}}},[adjustNext,adjustPrevious,tabs.length,width]);var scrollToTabRef=React.useRef(scrollToTab);React.useEffect(function(){scrollToTabRef.current=scrollToTab;},[scrollToTab]);React.useEffect(function(){scrollToTabRef.current(activeTab);},[activeTab,width]);React.useEffect(function(){var _horizontalScrollRef$5,_horizontalScrollRef$6;(_horizontalScrollRef$5=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$5.scrollTo({x:1});(_horizontalScrollRef$6=horizontalScrollRef.current)==null?void 0:_horizontalScrollRef$6.scrollTo({x:0});},[]);var onTabLayout=React.useCallback(function(page){return function(e){var tabWidth=e.nativeEvent.layout.width;setTabsWidth(function(prevTabsWidth){var newTabsWidth=prevTabsWidth.slice();newTabsWidth[page]=tabWidth;return newTabsWidth;});};},[]);var onTabPress=React.useCallback(function(page){return function(){scrollToTab(page);onTabPressed(page);};},[onTabPressed,scrollToTab]);var renderIcon=React.useCallback(function(icon,page){var isActive=activeTab===page;if(typeof icon==='function'){return icon(isActive);}return icon;},[activeTab]);var HORIZONTAL_PADDINGS=tabsContainerHorizontalPadding!=null?tabsContainerHorizontalPadding:UNDERLINE_PADDING;var allSizes=tabsWidth.every(function(it){return!!it;})&&tabsWidth.length>0&&!!tabUnderlineColor;var _React$useMemo=React.useMemo(function(){var inRange=allSizes?[0]:[0,1];var translateXOutRange=allSizes?[HORIZONTAL_PADDINGS]:[HORIZONTAL_PADDINGS,100];var widthOutRange=translateXOutRange.slice();if(tabUnderlineColor){tabsWidth.reduce(function(accTabWidth,tabWidth,index){if(allSizes){widthOutRange[index]=tabWidth;if(index>0){inRange[index]=width*index;translateXOutRange[index]=accTabWidth;}return accTabWidth+tabWidth;}return accTabWidth;},HORIZONTAL_PADDINGS);}return{inputRange:inRange,translateXOutputRange:translateXOutRange,widthOutputRange:widthOutRange};},[tabsWidth,tabUnderlineColor,HORIZONTAL_PADDINGS,allSizes,width]),inputRange=_React$useMemo.inputRange,translateXOutputRange=_React$useMemo.translateXOutputRange,widthOutputRange=_React$useMemo.widthOutputRange;var tabUnderlineAnimatedStyle=(0,_reactNativeReanimated.useAnimatedStyle)(function(){var translateX=(0,_reactNativeReanimated.interpolate)(horizontalScrollValue.value,inputRange,translateXOutputRange);return{backgroundColor:(0,_parseAnimatedColorProp.parseAnimatedColorProp)(tabUnderlineColor),transform:[{translateX:isInvertedIOS?translateX*-1:translateX}],width:(0,_reactNativeReanimated.interpolate)(horizontalScrollValue.value,inputRange,widthOutputRange)};},[horizontalScrollValue,inputRange,isInvertedIOS,tabUnderlineColor,translateXOutputRange,widthOutputRange]);var containerAnimatedStyle=(0,_reactNativeReanimated.useAnimatedStyle)(function(){return{backgroundColor:(0,_parseAnimatedColorProp.parseAnimatedColorProp)(tabsContainerBackgroundColor)};},[tabsContainerBackgroundColor]);return React.createElement(_reactNativeReanimated.default.View,{style:[styles.container,containerAnimatedStyle],__self:_this,__source:{fileName:_jsxFileName,lineNumber:202,columnNumber:5}},React.createElement(_reactNative.ScrollView,{ref:horizontalScrollRef,bounces:false,contentContainerStyle:[styles.contentContainer,_reactNative.Platform.OS==='android'?_reactNative.I18nManager.isRTL?_constants.commonStyles.rowReverse:_constants.commonStyles.row:null,tabsContainerStyle,styles.noMargins,{paddingHorizontal:HORIZONTAL_PADDINGS}],horizontal:true,onScrollEndDrag:function onScrollEndDrag(event){return currentPositionX.current=event.nativeEvent.contentOffset.x;},showsHorizontalScrollIndicator:false,style:[styles.nestedStyle,isInvertedAndroid&&styles.inversionStyle],__self:_this,__source:{fileName:_jsxFileName,lineNumber:203,columnNumber:7}},tabs.map(function(tab,page){return React.createElement(_TabItem.TabItem,{key:page,tab:tab,page:page,activeTab:activeTab,renderIcon:renderIcon,onTabLayout:onTabLayout(page),onTabPress:onTabPress(page),tabTextActiveStyle:tabTextActiveStyle,tabTextContainerActiveStyle:tabTextContainerActiveStyle,tabTextContainerStyle:tabTextContainerStyle,tabTextStyle:tabTextStyle,tabWrapperStyle:tabWrapperStyle,__self:_this,__source:{fileName:_jsxFileName,lineNumber:222,columnNumber:11}});}),tabUnderlineColor?React.createElement(_reactNativeReanimated.default.View,{style:[styles.tabUnderlineStyles,tabUnderlineAnimatedStyle],__self:_this,__source:{fileName:_jsxFileName,lineNumber:238,columnNumber:11}}):null));};exports.Tabs=Tabs;var styles=_reactNative.StyleSheet.create({container:{alignItems:'center',alignSelf:'stretch'},contentContainer:{alignItems:'center',flexGrow:1,justifyContent:'space-between'},inversionStyle:{transform:[{scaleX:-1}]},nestedStyle:{alignSelf:'stretch'},noMargins:{marginHorizontal:0,paddingHorizontal:0},tabUnderlineStyles:{position:'absolute',bottom:0,borderRadius:6,height:3}});
//# sourceMappingURL=Tabs.js.map